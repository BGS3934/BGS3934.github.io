<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>

      <!-- Right-hand controller with raycasting -->
      <a-entity id="rightHand"
                laser-controls="hand: right"
                raycaster="objects: .interactable"
                line="color: red; opacity: 0.75">
      </a-entity>

      <!-- Interactive box -->
      <a-box class="interactable"
             id="targetBox"
             position="0 1.5 -3"
             depth="1" height="1" width="1"
             color="#4CC3D9">
      </a-box>

      <!-- Ground and sky -->
      <a-plane rotation="-90 0 0" width="10" height="10" color="#7BC8A4"></a-plane>
      <a-sky color="#ECECEC"></a-sky>

      <!-- Hover + Click behavior -->
      <script>
        AFRAME.registerComponent('hover-and-click-color', {
          init: function () {
            const el = this.el;
            let originalColor = el.getAttribute('color');
            let clickedColor = '#EF2D5E';
            let hoverColor = '#FFFF00';
            let isHovered = false;

            el.addEventListener('raycaster-intersected', function () {
              if (!isHovered) {
                originalColor = el.getAttribute('color');
                el.setAttribute('color', hoverColor);
                isHovered = true;
              }
            });

            el.addEventListener('raycaster-intersected-cleared', function () {
              el.setAttribute('color', originalColor);
              isHovered = false;
            });

            el.addEventListener('click', function () {
              el.setAttribute('color', clickedColor);
              originalColor = clickedColor; // persist new base color
            });
          }
        });

        // Attach the behavior to the box
        document.addEventListener('DOMContentLoaded', () => {
          document.querySelector('#targetBox').setAttribute('hover-and-click-color', '');
        });
        
      </script>
    </a-scene>
  </body>
</html>
